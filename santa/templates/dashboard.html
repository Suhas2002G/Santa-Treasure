{% extends 'adminbase.html' %}
{% load static %}

{% block 'main' %}

<!-- Container for Admin Dashboard -->
<div class="dash-container">
    <h1 class="text-center mb-4" style="margin-top: 50px;">Welcome to the Admin Dashboard</h1>
    
    <!-- Dashboard Cards -->
    <div class="row">
        <div class="col-md-4">
        <a href="/filter_status/1" style="text-decoration: none;">
            <div class="card total-orders-card">
                <div class="card-body">
                    <h5 class="dash-card-title">Total Orders</h5>
                    <p class="dash-card-text">{{total_orders}}</p>
                </div>
            </div>
        </a>
        </div>
        <div class="col-md-4">
            <a href="/filter_status/2" style="text-decoration: none;">
            <div class="card pending-orders-card">
                <div class="card-body">
                    <h5 class="dash-card-title">Pending Orders</h5>
                    <p class="dash-card-text">{{pending_orders}}</p>
                </div>
            </div>
        </a>
        </div>
        <div class="col-md-4">
            <a href="/filter_status/3" style="text-decoration: none;">
            <div class="card delivered-orders-card">
                <div class="card-body">
                    <h5 class="dash-card-title">Delivered Orders</h5>
                    <p class="dash-card-text">{{delivered_orders}}</p>
                </div>
            </div>
        </a>
        </div>
    </div>



<!-- search / filter based on location  -->
    <form action="/search_location">
        <div class="search-bar">
          <input type="text" name="srchloc" placeholder="Search for order..." class="search-input" />
          <button class="search-btn">Search</button>
        </div>
      </form>





    <!-- Orders Table -->
    <h3 class="mt-5">Recent Orders</h3>
    {% if errmsg %}
            <div class="alert alert-danger" role="alert">
                {{errmsg}}
            </div>
        {% endif %}
    <table class="table table-bordered table-striped">
        <thead>
            <tr>
                <th>Order ID</th>
                <th>Date</th>
                <th>Customer Name</th>
                <th>Location</th>
                <th>Order Status</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            {% for order in data %}
            <tr>
                <td>{{ order.id }}</td>
                <td>{{ order.created_at|date:"Y-m-d" }}</td>
                <td>{{ order.uid.first_name }} {{ order.uid.last_name }}</td>
                <td>
                    {% for address in order.uid.address_set.all %}
                        {{ address.street_address }}, {{ address.city }}, {{ address.postal_code }}
                    {% empty %}
                        No address available
                    {% endfor %}
                </td>
                <td>{{order.status}}</td>
                <td><a href="/vieworder/{{ order.id }}" class="btn btn-primary">View</a></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% endblock 'main' %}